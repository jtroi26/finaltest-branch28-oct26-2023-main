<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Student-Lessons | DAZSMA </title>
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/dazsma-logo.ico" />
    <link href="/assets/libs/flot/css/float-chart.css" rel="stylesheet" />
    <link href="/dist/css/style.min.css" rel="stylesheet" />

    <style>
             

        /* Button used to open the contact form - fixed at the bottom of the page */
        .open-button {
        background-color: #555;
        color: white;
        padding: 16px 20px;
        border: none;
        cursor: pointer;
        opacity: 0.8;
        position: fixed;
        bottom: 23px;
        right: 28px;
        width: 280px;
        }

        /* The popup form - hidden by default */
        .form-popup {
        display: none;
        position: fixed;
        bottom: 0;
        right: 15px;
        border: 3px solid #f1f1f1;
        z-index: 9;
        }

        /* Add styles to the form container */
        .form-container {
        max-width: 300px;
        padding: 10px;
        background-color: white;
        }

        /* Full-width input fields */
        .form-container input[type=text], .form-container input[type=password] {
        width: 100%;
        padding: 15px;
        margin: 5px 0 22px 0;
        border: none;
        background: #f1f1f1;
        }

        /* When the inputs get focus, do something */
        .form-container input[type=text]:focus, .form-container input[type=password]:focus {
        background-color: #ddd;
        outline: none;
        }

        /* Set a style for the submit/login button */
        .form-container .btn {
        background-color: #04AA6D;
        color: white;
        padding: 16px 20px;
        border: none;
        cursor: pointer;
        width: 100%;
        margin-bottom:10px;
        opacity: 0.8;
        }

        /* Add a red background color to the cancel button */
        .form-container .cancel {
        background-color: red;
        }

        /* Add some hover effects to buttons */
        .form-container .btn:hover, .open-button:hover {
        opacity: 1;
        }

        .chat-container {
            max-width: 80%;
            margin: auto;
            overflow-y: auto;
            max-height: 300px; /* Adjust the height or remove for unlimited scroll */
        }

        .user-message {
            background-color: #e6f7ff;
            width: 150px;
            float: right;
            clear: both;
            margin-bottom: 10px;
        }

        .bot-message {
            background-color: #d9f5d9;
            width: 150px;
            float: left;
            clear: both;
            margin-bottom: 10px;
            
        }

        .message {
            padding: 8px;
            border-radius: 5px;
            word-wrap: break-word; /* To wrap long messages */
        }
    </style>

</head>
<% if (studentid) { %> 

    <body>
        <div class="preloader">
            <div class="lds-ripple">
                <div class="lds-pos"></div>
                <div class="lds-pos"></div>
            </div>
        </div>
        <div id="main-wrapper" data-layout="vertical" data-navbarbg="skin5" data-sidebartype="full"
            data-sidebar-position="absolute" data-header-position="absolute" data-boxed-layout="full">
            <header class="topbar" data-navbarbg="skin5">
                <nav class="navbar top-navbar navbar-expand-md navbar-dark">
                    <div class="navbar-header" data-logobg="skin5">
                        <a class="navbar-brand" href="/student/dashboard">
                            <b class="logo-icon ps-2">
                                <img src="/assets/images/dazsma-logo.png" alt="homepage" class="light-logo"
                                    width="25" />
                            </b>
                            <span class="logo-text ms-2">
                                <span>DAZSMA</span>
                            </span>
                        </a>
                        <a class="nav-toggler waves-effect waves-dark d-block d-md-none" href="javascript:void(0)"><i
                                class="ti-menu ti-close"></i></a>
                    </div>
                    <div class="navbar-collapse collapse" id="navbarSupportedContent" data-navbarbg="skin5">
                        <ul class="navbar-nav float-start me-auto">
                            <li class="nav-item d-none d-lg-block">
                                <a class="nav-link sidebartoggler waves-effect waves-light" href="javascript:void(0)"
                                    data-sidebartype="mini-sidebar"><i class="mdi mdi-menu font-24"></i></a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </header>
            <aside class="left-sidebar" data-sidebarbg="skin5">
                <div class="scroll-sidebar">
                    <nav class="sidebar-nav">
                        <ul id="sidebarnav" class="pt-4">
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/student/dashboard"
                                    aria-expanded="false"><i class="mdi mdi-view-dashboard"></i><span
                                        class="hide-menu">Dashboard</span></a>
                            </li>

                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                    href="/student/view/classmates" aria-expanded="false"><i
                                        class="mdi mdi-account-multiple"></i><span
                                        class="hide-menu">Classmates</span></a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                    href="/student/view/announcement" aria-expanded="false"><i
                                        class="mdi mdi-bullhorn"></i><span class="hide-menu">Announcements</span></a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                    href="/student/view/lessons" style="margin-bottom: 408px;" aria-expanded="false"><i
                                        class="mdi mdi-book-multiple"></i><span class="hide-menu">Lessons</span></a>
                            </li>
                            <% if (studentid) { %>
                                <form id="logoutForm" action="/logout" method="post">
                                    <li class="sidebar-item">
                                        <a href="javascript:void(0);"
                                            class="sidebar-link waves-effect waves-dark sidebar-link"
                                            onclick="document.getElementById('logoutForm').submit();"
                                            aria-expanded="false"><i class="mdi mdi-logout"></i><span
                                                class="hide-menu">Logout</span></a>
                                    </li>
                                </form>
                                <% } else { %>
                                    <li class="sidebar-item">
                                        <a href="/" class="sidebar-link waves-effect waves-dark sidebar-link"
                                            style="margin-top: auto;" aria-expanded="false"><i
                                                class="mdi mdi-login"></i><span class="hide-menu">Login</span></a>
                                    </li>
                                    <% } %>
                        </ul>
                    </nav>
                </div>
            </aside>
            <div class="page-wrapper">
                <div class="page-breadcrumb">
                    <div class="row">
                        <div class="col-12 d-flex no-block align-items-center">
                            <h4 class="page-title">Lesson > <%= lessonData.lessonTitle %>
                            </h4>
                            <div class="ms-auto text-end">
                                <nav aria-label="breadcrumb">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="/student/dashboard">Home</a></li>
                                        <li class="breadcrumb-item active" aria-current="page">Lesson</li>
                                    </ol>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container-fluid">
                    <div class="row ">
                        <div class="col-12">
                            <div class="card">
                                <% for (let i=1; i <=10; i++) { %>
                                    <div class="card-body">

                                        <div id="announcementDiv<%= i %>">
                                            <p>
                                                <%- lessonData['section' + i] %>
                                            </p>
                                        </div>
                                    

                                    <button onclick="toggleSpeak()">Speak</button>

                                        <button class="open-button" onclick="openForm()">Open Form</button>

    <div class="form-popup" id="myForm">
        
        <h1 style="margin-left: 10px;">Trivia</h1>

        <div class="chat-container">
            <% if (chatHistory && chatHistory.length > 0) { %>
                <% chatHistory.forEach(message => { %>
                    <div class="message <%= message.role === 'user' ? 'user-message' : 'bot-message' %>">
                        <%= message.content %>
                    </div>
                <% }); %>
            <% } %>
        </div>
    
        <form action="/student/view/lesson/ai" method="post" class="form-container">
            <label for="userInput">Enter your message:</label>
            <input type="text" id="userInput" name="userInput" required>
            <button type="submit">Submit</button>

            <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
        </form>
    </div>


                                    <script>
                                        var synthesis = window.speechSynthesis;
                                        var utterance;
                                
                                        function toggleSpeak() {
                                            // Modify this to get the currently displayed section (e.g., section 1, section 2, etc.)
                                            var currentSection = 1; // Replace this with your logic to determine the current section
                                            var announcementText = document.getElementById('announcementDiv' + currentSection).innerText;
                                
                                            // Check for browser support
                                            if ('speechSynthesis' in window) {
                                                if (synthesis.speaking || synthesis.paused) {
                                                    // If speech is currently active or paused, stop it
                                                    synthesis.cancel();
                                                } else {
                                                    // If speech is not active, start it
                                                    utterance = new SpeechSynthesisUtterance(announcementText);
                                                    synthesis.speak(utterance);
                                                }
                                            } else {
                                                alert('Text-to-speech is not supported in this browser.');
                                            }
                                        }
                                    </script>

                                    </div>
                                    <!-- <hr> -->
                                    <% } %>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <script>
            function openForm() {
              document.getElementById("myForm").style.display = "block";
            }
            
            function closeForm() {
              document.getElementById("myForm").style.display = "none";
            }
            </script>

        <script src="/assets/libs/jquery/dist/jquery.min.js"></script>
        <script src="/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
        <script src="/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js"></script>
        <script src="/assets/extra-libs/sparkline/sparkline.js"></script>
        <script src="/dist/js/waves.js"></script>
        <script src="/dist/js/sidebarmenu.js"></script>
        <script src="/dist/js/custom.min.js"></script>
        <script src="/assets/libs/flot/excanvas.js"></script>
        <script src="/assets/libs/flot/jquery.flot.js"></script>
        <script src="/assets/libs/flot/jquery.flot.pie.js"></script>
        <script src="/assets/libs/flot/jquery.flot.time.js"></script>
        <script src="/assets/libs/flot/jquery.flot.stack.js"></script>
        <script src="/assets/libs/flot/jquery.flot.crosshair.js"></script>
        <script src="/assets/libs/flot.tooltip/js/jquery.flot.tooltip.min.js"></script>
        <script src="/dist/js/pages/chart/chart-page-init.js"></script>
    </body>
    <% } else { %>
        <div class="error-box">
          <div class="error-body text-center">
            <h1 class="error-title text-info">403</h1>
            <h3 class="text-uppercase error-subtitle">ACCESS FORBIDDEN !</h3>
            <p class="text-muted mt-4 mb-4">
              YOU SEEM TO BE TRYING TO FIND HIS WAY HOME
            </p>
            <a href="/" class="
          btn btn-info btn-rounded
          waves-effect waves-light
          mb-5
          text-white
        ">Back to home</a>
          </div>
        </div>
        <% } %>

</html>